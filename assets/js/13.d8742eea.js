(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{363:function(s,e,t){"use strict";t.r(e);var n=t(25),a=Object(n.a)({},(function(){var s=this,e=s.$createElement,t=s._self._c||e;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"cache-session"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#cache-session"}},[s._v("#")]),s._v(" Cache | Session")]),s._v(" "),t("h2",{attrs:{id:"_1-cache"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-cache"}},[s._v("#")]),s._v(" 1. Cache")]),s._v(" "),t("p",[s._v("Asp.Net Core不再支持"),t("code",[s._v("HttpContext.Cache")]),s._v(",转而使用"),t("a",{attrs:{href:"https://docs.microsoft.com/zh-cn/aspnet/core/performance/caching/memory?view=aspnetcore-2.2",target:"_blank",rel:"noopener noreferrer"}},[t("code",[s._v("MemoryCache")]),t("OutboundLink")],1),s._v(",这是一种服务端内存缓存。使用方式方式非常简单，在"),t("code",[s._v("Startup")]),s._v("的"),t("code",[s._v("ConfigureServices")]),s._v("方法中注册服务，需要使用的位置注入"),t("code",[s._v("IMemoryCache")]),s._v("对象即可。")]),s._v(" "),t("p",[s._v("除了内存缓存，我们还可以使用Redis等"),t("a",{attrs:{href:"https://docs.microsoft.com/zh-cn/aspnet/core/performance/caching/distributed?view=aspnetcore-2.2",target:"_blank",rel:"noopener noreferrer"}},[s._v("分布式缓存"),t("OutboundLink")],1)]),s._v(" "),t("h2",{attrs:{id:"_2-session"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-session"}},[s._v("#")]),s._v(" 2. Session")]),s._v(" "),t("p",[s._v("在Asp.Net Core中使用Session需要首先添加对Session的支持,否则会报错"),t("code",[s._v("Session has not been configured for this application or request")]),s._v("。")]),s._v(" "),t("p",[s._v("Session使用步骤：")]),s._v(" "),t("ul",[t("li",[t("ol",[t("li",[s._v("注册服务。"),t("code",[s._v("ConfigureServices")]),s._v("中"),t("code",[s._v("services.AddSession()")]),s._v(";")])])]),s._v(" "),t("li",[t("ol",{attrs:{start:"2"}},[t("li",[s._v("注册中间件。"),t("code",[s._v("Configure")]),s._v("中"),t("code",[s._v("app.UseSession()")]),s._v(";")])])]),s._v(" "),t("li",[s._v("3）使用Session")])]),s._v(" "),t("div",{staticClass:"language-csharp line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-csharp"}},[t("code",[s._v("HttpContext"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Session"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("SetString")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"userName"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Colin"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("string")])]),s._v(" userName "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" HttpContext"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Session"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("GetString")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"userName"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("目前Session默认仅支持存储"),t("code",[s._v("int")]),s._v("、"),t("code",[s._v("string")]),s._v("和"),t("code",[s._v("byte[]")]),s._v("类型，其他复杂类型可以使用json序列化后存储字符串。")]),s._v(" "),t("p",[s._v("TempData也依赖于 Session,所以也要配置 Session。")]),s._v(" "),t("p",[s._v("默认Session为服务器端进程内存储，我们也可以使用Redis做进程外Session。")])])}),[],!1,null,null,null);e.default=a.exports}}]);